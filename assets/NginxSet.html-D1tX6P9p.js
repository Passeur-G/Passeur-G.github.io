import{_ as e,r as p,o as i,c as o,b as s,d as n,a,e as c}from"./app-BBFocvpl.js";const t={},r=c(`<div class="hint-container info"><p class="hint-container-title">Info</p><p>Nginx的文件配置详解</p></div><h2 id="nginx的配置文件" tabindex="-1"><a class="header-anchor" href="#nginx的配置文件"><span>Nginx的配置文件</span></a></h2><div class="language-nginx line-numbers-mode" data-ext="nginx" data-title="nginx"><pre class="shiki one-dark-pro" style="background-color:#282c34;color:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 全局参数</span></span>
<span class="line"><span style="color:#C678DD;">user </span><span style="color:#ABB2BF;">nginx;              </span><span style="color:#7F848E;font-style:italic;"># Nginx进程运行用户</span></span>
<span class="line"><span style="color:#C678DD;">worker_processes </span><span style="color:#ABB2BF;">auto;   </span><span style="color:#7F848E;font-style:italic;"># Nginx工作进程数，通常设置为CPU核数</span></span>
<span class="line"><span style="color:#C678DD;">error_log </span><span style="color:#ABB2BF;">/var/log/nginx/error.log</span><span style="color:#D19A66;"> warn</span><span style="color:#ABB2BF;">;    </span><span style="color:#7F848E;font-style:italic;"># 错误日志路径和日志级别</span></span>
<span class="line"><span style="color:#C678DD;">pid </span><span style="color:#ABB2BF;">/run/nginx.pid;      </span><span style="color:#7F848E;font-style:italic;"># 进程PID保存路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 定义事件模块</span></span>
<span class="line"><span style="color:#C678DD;">events</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;"> worker_connections </span><span style="color:#ABB2BF;">1024;    </span><span style="color:#7F848E;font-style:italic;"># 每个工作进程最大并发连接数 </span></span>
<span class="line"><span style="color:#C678DD;"> use </span><span style="color:#ABB2BF;">epoll;                  </span><span style="color:#7F848E;font-style:italic;"># 使用epoll网络模型，提高性能</span></span>
<span class="line"><span style="color:#C678DD;"> multi_accept </span><span style="color:#ABB2BF;">on;            </span><span style="color:#7F848E;font-style:italic;"># 开启支持多个连接同时建立</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#7F848E;font-style:italic;">#配置服务器与用户的网络连接</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 定义HTTP服务器模块,用来配置代理、缓存、日志等</span></span>
<span class="line"><span style="color:#C678DD;">http</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 缓存文件目录</span></span>
<span class="line"><span style="color:#C678DD;"> client_body_temp_path </span><span style="color:#ABB2BF;">/var/cache/nginx/client_temp;</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_temp_path </span><span style="color:#ABB2BF;">/var/cache/nginx/proxy_temp;</span></span>
<span class="line"><span style="color:#C678DD;"> fastcgi_temp_path </span><span style="color:#ABB2BF;">/var/cache/nginx/fastcgi_temp;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 定义日志格式，main是默认的日志格式</span></span>
<span class="line"><span style="color:#C678DD;"> log_format </span><span style="color:#ABB2BF;">main </span><span style="color:#98C379;">&#39;$</span><span style="color:#E06C75;">remote_addr</span><span style="color:#98C379;"> - $</span><span style="color:#E06C75;">remote_user</span><span style="color:#98C379;"> [$</span><span style="color:#E06C75;">time_local</span><span style="color:#98C379;">] &quot;$</span><span style="color:#E06C75;">request</span><span style="color:#98C379;">&quot; &#39;</span></span>
<span class="line"><span style="color:#98C379;">     &#39;$</span><span style="color:#E06C75;">status</span><span style="color:#98C379;"> $</span><span style="color:#E06C75;">body_bytes_sent</span><span style="color:#98C379;"> &quot;$</span><span style="color:#E06C75;">http_referer</span><span style="color:#98C379;">&quot; &#39;</span></span>
<span class="line"><span style="color:#98C379;">     &#39;&quot;$</span><span style="color:#E06C75;">http_user_agent</span><span style="color:#98C379;">&quot; &quot;$</span><span style="color:#E06C75;">http_x_forwarded_for</span><span style="color:#98C379;">&quot;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 默认访问日志保存路径和格式</span></span>
<span class="line"><span style="color:#C678DD;"> access_log </span><span style="color:#ABB2BF;">/var/log/nginx/access.log</span><span style="color:#D19A66;"> main</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 定义MIME类型 配置Nginx支持的媒体类型</span></span>
<span class="line"><span style="color:#C678DD;"> include </span><span style="color:#ABB2BF;">/etc/nginx/mime.types;</span></span>
<span class="line"><span style="color:#C678DD;"> default_type </span><span style="color:#ABB2BF;">application/octet-stream; </span><span style="color:#7F848E;font-style:italic;">#默认类型</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	sendfile	</span><span style="color:#ABB2BF;">on;</span><span style="color:#7F848E;font-style:italic;">#是否开启高效传输模式</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> #tcp_nopush	on;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> #超时时间</span></span>
<span class="line"><span style="color:#C678DD;"> keepalive_timeout	</span><span style="color:#ABB2BF;">0;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 代理参数</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_connect_timeout </span><span style="color:#ABB2BF;">6s;       </span><span style="color:#7F848E;font-style:italic;"># 连接超时时间</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_send_timeout </span><span style="color:#ABB2BF;">10s;         </span><span style="color:#7F848E;font-style:italic;"># 发送超时时间</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_read_timeout </span><span style="color:#ABB2BF;">10s;         </span><span style="color:#7F848E;font-style:italic;"># 接收超时时间</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_buffer_size </span><span style="color:#ABB2BF;">16k;          </span><span style="color:#7F848E;font-style:italic;"># 缓冲区大小</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_buffers </span><span style="color:#ABB2BF;">4 </span><span style="color:#D19A66;">32k</span><span style="color:#ABB2BF;">;            </span><span style="color:#7F848E;font-style:italic;"># 缓冲区个数和大小</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_busy_buffers_size </span><span style="color:#ABB2BF;">64k;    </span><span style="color:#7F848E;font-style:italic;"># 忙碌缓冲区大小</span></span>
<span class="line"><span style="color:#C678DD;"> proxy_temp_file_write_size </span><span style="color:#ABB2BF;">64k; </span><span style="color:#7F848E;font-style:italic;"># 代理临时文件写入大小</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 启用压缩，可以提高网站访问速度</span></span>
<span class="line"><span style="color:#C678DD;"> gzip </span><span style="color:#ABB2BF;">on;</span></span>
<span class="line"><span style="color:#C678DD;"> gzip_min_length </span><span style="color:#ABB2BF;">1k;                    </span><span style="color:#7F848E;font-style:italic;"># 最小压缩文件大小</span></span>
<span class="line"><span style="color:#C678DD;"> gzip_types </span><span style="color:#ABB2BF;">text/plain text/css application/json application/javascript application/xml;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 定义HTTP服务器 核心 用来配置网站</span></span>
<span class="line"><span style="color:#C678DD;"> server</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">     listen </span><span style="color:#ABB2BF;">80;              </span><span style="color:#7F848E;font-style:italic;"># 监听端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">     server_name </span><span style="color:#ABB2BF;">example.com;    </span><span style="color:#7F848E;font-style:italic;"># 域名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # 重定向到HTTPS，强制使用HTTPS访问</span></span>
<span class="line"><span style="color:#C678DD;">     if</span><span style="color:#ABB2BF;"> ($</span><span style="color:#E06C75;">scheme</span><span style="color:#ABB2BF;"> != </span><span style="color:#98C379;">&quot;https&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">         return</span><span style="color:#D19A66;"> 301</span><span style="color:#ABB2BF;"> https://$</span><span style="color:#E06C75;">server_name</span><span style="color:#ABB2BF;">$</span><span style="color:#E06C75;">request_uri</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # HTTPS服务器配置</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_certificate </span><span style="color:#ABB2BF;">     /etc/nginx/ssl/server.crt;    </span><span style="color:#7F848E;font-style:italic;"># SSL证书路径</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_certificate_key </span><span style="color:#ABB2BF;"> /etc/nginx/ssl/server.key;    </span><span style="color:#7F848E;font-style:italic;"># SSL私钥路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # SSL会话缓存参数</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_session_cache </span><span style="color:#ABB2BF;">shared:SSL:10m;</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_session_timeout </span><span style="color:#ABB2BF;">10m;</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_protocols </span><span style="color:#ABB2BF;">TLSv1 TLSv1.1 TLSv1.2;</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_prefer_server_ciphers </span><span style="color:#ABB2BF;">on;</span></span>
<span class="line"><span style="color:#C678DD;">     ssl_ciphers </span><span style="color:#ABB2BF;">ECDH+AESGCM:ECDH+AES256:ECDH+AES128:DH+3DES:!ADH:!AECDH:!MD5;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # 配置代理路径 相对与Nginx的安装路径</span></span>
<span class="line"><span style="color:#C678DD;">     location</span><span style="color:#ABB2BF;"> / {</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_pass </span><span style="color:#ABB2BF;">http://localhost:8080;        </span><span style="color:#7F848E;font-style:italic;"># 转发请求的目标地址</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_set_header </span><span style="color:#ABB2BF;">Host $</span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;">;             </span><span style="color:#7F848E;font-style:italic;"># 设置请求头中的Host字段</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_set_header </span><span style="color:#ABB2BF;">X-Forwarded-For $</span><span style="color:#E06C75;">proxy_add_x_forwarded_for</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                         # 设置HTTP头中的X-Forwarded-For字段，表示客户端真实IP，多个IP用逗号隔开</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_set_header </span><span style="color:#ABB2BF;">X-Real-IP $</span><span style="color:#E06C75;">remote_addr</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;"># 设置请求头中的X-Real-IP字段，表示客户端真实IP</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # 配置静态文件访问路径</span></span>
<span class="line"><span style="color:#C678DD;">     location</span><span style="color:#ABB2BF;"> /static/ {</span></span>
<span class="line"><span style="color:#C678DD;">         alias </span><span style="color:#ABB2BF;">/path/to/static/files/;   </span><span style="color:#7F848E;font-style:italic;"># 静态文件的目录</span></span>
<span class="line"><span style="color:#C678DD;">         expires </span><span style="color:#ABB2BF;">7d;                     </span><span style="color:#7F848E;font-style:italic;"># 静态文件缓存时间</span></span>
<span class="line"><span style="color:#C678DD;">         add_header </span><span style="color:#ABB2BF;">Pragma public;       </span><span style="color:#7F848E;font-style:italic;"># 添加HTTP响应头</span></span>
<span class="line"><span style="color:#C678DD;">         add_header </span><span style="color:#ABB2BF;">Cache-Control </span><span style="color:#98C379;">&quot;public, must-revalidate, proxy-revalidate&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # 配置错误页面</span></span>
<span class="line"><span style="color:#C678DD;">     error_page </span><span style="color:#ABB2BF;">404 /404.html;           </span><span style="color:#7F848E;font-style:italic;"># 404错误页</span></span>
<span class="line"><span style="color:#C678DD;">     location</span><span style="color:#ABB2BF;"> = </span><span style="color:#E06C75;">/404.html </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#C678DD;">         internal</span><span style="color:#ABB2BF;">;                       </span><span style="color:#7F848E;font-style:italic;"># 不接受外部访问</span></span>
<span class="line"><span style="color:#C678DD;">         root </span><span style="color:#ABB2BF;">/usr/share/nginx/html;     </span><span style="color:#7F848E;font-style:italic;"># 404错误页文件所在目录</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     # 配置重定向</span></span>
<span class="line"><span style="color:#C678DD;">     location</span><span style="color:#ABB2BF;"> /old/ {</span></span>
<span class="line"><span style="color:#C678DD;">         rewrite</span><span style="color:#E06C75;"> ^/old/([^/]+) /new/$</span><span style="color:#ABB2BF;">1 </span><span style="color:#C678DD;">permanent</span><span style="color:#ABB2BF;">;   </span><span style="color:#7F848E;font-style:italic;"># 将/old/xxx路径重定向为/new/xxx，返回301状态码</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 其他服务配置</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # server {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> #     ...</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> # 配置TCP负载均衡</span></span>
<span class="line"><span style="color:#C678DD;"> upstream</span><span style="color:#ABB2BF;"> backends {</span></span>
<span class="line"><span style="color:#C678DD;">     server</span><span style="color:#ABB2BF;"> backend1.example.com:8080 </span><span style="color:#E06C75;font-style:italic;">weight</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">;  </span><span style="color:#7F848E;font-style:italic;"># 后端服务器地址和权重</span></span>
<span class="line"><span style="color:#ABB2BF;">     server backend2.example.com:8080;</span></span>
<span class="line"><span style="color:#C678DD;">     server</span><span style="color:#ABB2BF;"> backend3.example.com:8080 backup;   </span><span style="color:#7F848E;font-style:italic;"># 备用服务器</span></span>
<span class="line"><span style="color:#C678DD;">     keepalive </span><span style="color:#ABB2BF;">16;                               </span><span style="color:#7F848E;font-style:italic;"># 连接池大小</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;"> server</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">     listen </span><span style="color:#ABB2BF;">80; </span><span style="color:#7F848E;font-style:italic;">#监听端口</span></span>
<span class="line"><span style="color:#C678DD;">     server_name </span><span style="color:#ABB2BF;">example.com;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">     location</span><span style="color:#ABB2BF;"> / {</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_pass </span><span style="color:#ABB2BF;">http://backends;             </span><span style="color:#7F848E;font-style:italic;"># 负载均衡转发请求的目标地址</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_set_header </span><span style="color:#ABB2BF;">Host $</span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;">;            </span><span style="color:#7F848E;font-style:italic;"># 设置请求头中的Host字段</span></span>
<span class="line"><span style="color:#C678DD;">         proxy_set_header </span><span style="color:#ABB2BF;">X-Real-IP $</span><span style="color:#E06C75;">remote_addr</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;"># 设置请求头中的X-Real-IP字段，表示客户端真实IP</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果worker数超过CPU核数，会导致进程之间来去竞争CPU资源，产生不必要的上下文切换</p><p><code>最大并发量</code>等于 worker进程的个数乘以连接上限，如果是反向代理，那么最大并发量需要除以2（因为每个并发会建立与客户端的连接和与后台服务器的连接，占用两个连接）</p>`,5),y={href:"https://www.cnblogs.com/hanease/p/15890509.html",target:"_blank",rel:"noopener noreferrer"},d={href:"https://www.w3cschool.cn/nginx/nginx-d1aw28wa.html",target:"_blank",rel:"noopener noreferrer"};function B(v,m){const l=p("ExternalLinkIcon");return i(),o("div",null,[r,s("p",null,[s("a",y,[n("nginx详细参数配置(史上最全) - hanease - 博客园 (cnblogs.com)"),a(l)]),n("、"),s("a",d,[n("Nginx 配置文件nginx.conf中文详解_w3cschool"),a(l)])])])}const F=e(t,[["render",B],["__file","NginxSet.html.vue"]]),b=JSON.parse(`{"path":"/posts/FrontEnd/Nginx/NginxSet.html","title":"Nginx配置","lang":"en-US","frontmatter":{"title":"Nginx配置","icon":"fa-b fa-neos","date":"2024-04-27T00:00:00.000Z","article":true,"description":"Info Nginx的文件配置详解 Nginx的配置文件 如果worker数超过CPU核数，会导致进程之间来去竞争CPU资源，产生不必要的上下文切换 最大并发量等于 worker进程的个数乘以连接上限，如果是反向代理，那么最大并发量需要除以2（因为每个并发会建立与客户端的连接和与后台服务器的连接，占用两个连接） nginx详细参数配置(史上最全) - ...","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://nulizongyouhuibao.space/zh/posts/FrontEnd/Nginx/NginxSet.html"}],["meta",{"property":"og:url","content":"https://nulizongyouhuibao.space/posts/FrontEnd/Nginx/NginxSet.html"}],["meta",{"property":"og:site_name","content":"GaLaXy"}],["meta",{"property":"og:title","content":"Nginx配置"}],["meta",{"property":"og:description","content":"Info Nginx的文件配置详解 Nginx的配置文件 如果worker数超过CPU核数，会导致进程之间来去竞争CPU资源，产生不必要的上下文切换 最大并发量等于 worker进程的个数乘以连接上限，如果是反向代理，那么最大并发量需要除以2（因为每个并发会建立与客户端的连接和与后台服务器的连接，占用两个连接） nginx详细参数配置(史上最全) - ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-27T14:38:25.000Z"}],["meta",{"property":"article:author","content":"Haitong Gao"}],["meta",{"property":"article:published_time","content":"2024-04-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-27T14:38:25.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx配置\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-04-27T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-27T14:38:25.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Haitong Gao\\",\\"url\\":\\"https://github.com/Passeur-G/Passeur-G.github.io\\",\\"email\\":\\"ght139439@qq.com\\"}]}"],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://nulizongyouhuibao.space/rss.xml","title":"GaLaXy RSS Feed"}]]},"headers":[{"level":2,"title":"Nginx的配置文件","slug":"nginx的配置文件","link":"#nginx的配置文件","children":[]}],"git":{"createdTime":1714228705000,"updatedTime":1714228705000,"contributors":[{"name":"Ght-139","email":"ght139439@qq.com","commits":1}]},"readingTime":{"minutes":3.07,"words":922},"filePathRelative":"posts/FrontEnd/Nginx/NginxSet.md","localizedDate":"April 27, 2024","excerpt":"<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">Info</p>\\n<p>Nginx的文件配置详解</p>\\n</div>\\n<h2>Nginx的配置文件</h2>\\n<div class=\\"language-nginx line-numbers-mode\\" data-ext=\\"nginx\\" data-title=\\"nginx\\"><pre class=\\"shiki one-dark-pro\\" style=\\"background-color:#282c34;color:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"># 全局参数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">user </span><span style=\\"color:#ABB2BF\\">nginx;              </span><span style=\\"color:#7F848E;font-style:italic\\"># Nginx进程运行用户</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">worker_processes </span><span style=\\"color:#ABB2BF\\">auto;   </span><span style=\\"color:#7F848E;font-style:italic\\"># Nginx工作进程数，通常设置为CPU核数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">error_log </span><span style=\\"color:#ABB2BF\\">/var/log/nginx/error.log</span><span style=\\"color:#D19A66\\"> warn</span><span style=\\"color:#ABB2BF\\">;    </span><span style=\\"color:#7F848E;font-style:italic\\"># 错误日志路径和日志级别</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">pid </span><span style=\\"color:#ABB2BF\\">/run/nginx.pid;      </span><span style=\\"color:#7F848E;font-style:italic\\"># 进程PID保存路径</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"># 定义事件模块</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">events</span><span style=\\"color:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> worker_connections </span><span style=\\"color:#ABB2BF\\">1024;    </span><span style=\\"color:#7F848E;font-style:italic\\"># 每个工作进程最大并发连接数 </span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> use </span><span style=\\"color:#ABB2BF\\">epoll;                  </span><span style=\\"color:#7F848E;font-style:italic\\"># 使用epoll网络模型，提高性能</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> multi_accept </span><span style=\\"color:#ABB2BF\\">on;            </span><span style=\\"color:#7F848E;font-style:italic\\"># 开启支持多个连接同时建立</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">} </span><span style=\\"color:#7F848E;font-style:italic\\">#配置服务器与用户的网络连接</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"># 定义HTTP服务器模块,用来配置代理、缓存、日志等</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">http</span><span style=\\"color:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 缓存文件目录</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> client_body_temp_path </span><span style=\\"color:#ABB2BF\\">/var/cache/nginx/client_temp;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_temp_path </span><span style=\\"color:#ABB2BF\\">/var/cache/nginx/proxy_temp;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> fastcgi_temp_path </span><span style=\\"color:#ABB2BF\\">/var/cache/nginx/fastcgi_temp;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 定义日志格式，main是默认的日志格式</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> log_format </span><span style=\\"color:#ABB2BF\\">main </span><span style=\\"color:#98C379\\">'$</span><span style=\\"color:#E06C75\\">remote_addr</span><span style=\\"color:#98C379\\"> - $</span><span style=\\"color:#E06C75\\">remote_user</span><span style=\\"color:#98C379\\"> [$</span><span style=\\"color:#E06C75\\">time_local</span><span style=\\"color:#98C379\\">] \\"$</span><span style=\\"color:#E06C75\\">request</span><span style=\\"color:#98C379\\">\\" '</span></span>\\n<span class=\\"line\\"><span style=\\"color:#98C379\\">     '$</span><span style=\\"color:#E06C75\\">status</span><span style=\\"color:#98C379\\"> $</span><span style=\\"color:#E06C75\\">body_bytes_sent</span><span style=\\"color:#98C379\\"> \\"$</span><span style=\\"color:#E06C75\\">http_referer</span><span style=\\"color:#98C379\\">\\" '</span></span>\\n<span class=\\"line\\"><span style=\\"color:#98C379\\">     '\\"$</span><span style=\\"color:#E06C75\\">http_user_agent</span><span style=\\"color:#98C379\\">\\" \\"$</span><span style=\\"color:#E06C75\\">http_x_forwarded_for</span><span style=\\"color:#98C379\\">\\"'</span><span style=\\"color:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 默认访问日志保存路径和格式</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> access_log </span><span style=\\"color:#ABB2BF\\">/var/log/nginx/access.log</span><span style=\\"color:#D19A66\\"> main</span><span style=\\"color:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 定义MIME类型 配置Nginx支持的媒体类型</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> include </span><span style=\\"color:#ABB2BF\\">/etc/nginx/mime.types;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> default_type </span><span style=\\"color:#ABB2BF\\">application/octet-stream; </span><span style=\\"color:#7F848E;font-style:italic\\">#默认类型</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">\\tsendfile\\t</span><span style=\\"color:#ABB2BF\\">on;</span><span style=\\"color:#7F848E;font-style:italic\\">#是否开启高效传输模式</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> #tcp_nopush\\ton;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> #超时时间</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> keepalive_timeout\\t</span><span style=\\"color:#ABB2BF\\">0;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 代理参数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_connect_timeout </span><span style=\\"color:#ABB2BF\\">6s;       </span><span style=\\"color:#7F848E;font-style:italic\\"># 连接超时时间</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_send_timeout </span><span style=\\"color:#ABB2BF\\">10s;         </span><span style=\\"color:#7F848E;font-style:italic\\"># 发送超时时间</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_read_timeout </span><span style=\\"color:#ABB2BF\\">10s;         </span><span style=\\"color:#7F848E;font-style:italic\\"># 接收超时时间</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_buffer_size </span><span style=\\"color:#ABB2BF\\">16k;          </span><span style=\\"color:#7F848E;font-style:italic\\"># 缓冲区大小</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_buffers </span><span style=\\"color:#ABB2BF\\">4 </span><span style=\\"color:#D19A66\\">32k</span><span style=\\"color:#ABB2BF\\">;            </span><span style=\\"color:#7F848E;font-style:italic\\"># 缓冲区个数和大小</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_busy_buffers_size </span><span style=\\"color:#ABB2BF\\">64k;    </span><span style=\\"color:#7F848E;font-style:italic\\"># 忙碌缓冲区大小</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> proxy_temp_file_write_size </span><span style=\\"color:#ABB2BF\\">64k; </span><span style=\\"color:#7F848E;font-style:italic\\"># 代理临时文件写入大小</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 启用压缩，可以提高网站访问速度</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> gzip </span><span style=\\"color:#ABB2BF\\">on;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> gzip_min_length </span><span style=\\"color:#ABB2BF\\">1k;                    </span><span style=\\"color:#7F848E;font-style:italic\\"># 最小压缩文件大小</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> gzip_types </span><span style=\\"color:#ABB2BF\\">text/plain text/css application/json application/javascript application/xml;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 定义HTTP服务器 核心 用来配置网站</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> server</span><span style=\\"color:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     listen </span><span style=\\"color:#ABB2BF\\">80;              </span><span style=\\"color:#7F848E;font-style:italic\\"># 监听端口</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     server_name </span><span style=\\"color:#ABB2BF\\">example.com;    </span><span style=\\"color:#7F848E;font-style:italic\\"># 域名</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # 重定向到HTTPS，强制使用HTTPS访问</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     if</span><span style=\\"color:#ABB2BF\\"> ($</span><span style=\\"color:#E06C75\\">scheme</span><span style=\\"color:#ABB2BF\\"> != </span><span style=\\"color:#98C379\\">\\"https\\"</span><span style=\\"color:#ABB2BF\\">) {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         return</span><span style=\\"color:#D19A66\\"> 301</span><span style=\\"color:#ABB2BF\\"> https://$</span><span style=\\"color:#E06C75\\">server_name</span><span style=\\"color:#ABB2BF\\">$</span><span style=\\"color:#E06C75\\">request_uri</span><span style=\\"color:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # HTTPS服务器配置</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_certificate </span><span style=\\"color:#ABB2BF\\">     /etc/nginx/ssl/server.crt;    </span><span style=\\"color:#7F848E;font-style:italic\\"># SSL证书路径</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_certificate_key </span><span style=\\"color:#ABB2BF\\"> /etc/nginx/ssl/server.key;    </span><span style=\\"color:#7F848E;font-style:italic\\"># SSL私钥路径</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # SSL会话缓存参数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_session_cache </span><span style=\\"color:#ABB2BF\\">shared:SSL:10m;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_session_timeout </span><span style=\\"color:#ABB2BF\\">10m;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_protocols </span><span style=\\"color:#ABB2BF\\">TLSv1 TLSv1.1 TLSv1.2;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_prefer_server_ciphers </span><span style=\\"color:#ABB2BF\\">on;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     ssl_ciphers </span><span style=\\"color:#ABB2BF\\">ECDH+AESGCM:ECDH+AES256:ECDH+AES128:DH+3DES:!ADH:!AECDH:!MD5;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # 配置代理路径 相对与Nginx的安装路径</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     location</span><span style=\\"color:#ABB2BF\\"> / {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_pass </span><span style=\\"color:#ABB2BF\\">http://localhost:8080;        </span><span style=\\"color:#7F848E;font-style:italic\\"># 转发请求的目标地址</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_set_header </span><span style=\\"color:#ABB2BF\\">Host $</span><span style=\\"color:#E06C75\\">host</span><span style=\\"color:#ABB2BF\\">;             </span><span style=\\"color:#7F848E;font-style:italic\\"># 设置请求头中的Host字段</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_set_header </span><span style=\\"color:#ABB2BF\\">X-Forwarded-For $</span><span style=\\"color:#E06C75\\">proxy_add_x_forwarded_for</span><span style=\\"color:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">                         # 设置HTTP头中的X-Forwarded-For字段，表示客户端真实IP，多个IP用逗号隔开</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_set_header </span><span style=\\"color:#ABB2BF\\">X-Real-IP $</span><span style=\\"color:#E06C75\\">remote_addr</span><span style=\\"color:#ABB2BF\\">; </span><span style=\\"color:#7F848E;font-style:italic\\"># 设置请求头中的X-Real-IP字段，表示客户端真实IP</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # 配置静态文件访问路径</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     location</span><span style=\\"color:#ABB2BF\\"> /static/ {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         alias </span><span style=\\"color:#ABB2BF\\">/path/to/static/files/;   </span><span style=\\"color:#7F848E;font-style:italic\\"># 静态文件的目录</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         expires </span><span style=\\"color:#ABB2BF\\">7d;                     </span><span style=\\"color:#7F848E;font-style:italic\\"># 静态文件缓存时间</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         add_header </span><span style=\\"color:#ABB2BF\\">Pragma public;       </span><span style=\\"color:#7F848E;font-style:italic\\"># 添加HTTP响应头</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         add_header </span><span style=\\"color:#ABB2BF\\">Cache-Control </span><span style=\\"color:#98C379\\">\\"public, must-revalidate, proxy-revalidate\\"</span><span style=\\"color:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # 配置错误页面</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     error_page </span><span style=\\"color:#ABB2BF\\">404 /404.html;           </span><span style=\\"color:#7F848E;font-style:italic\\"># 404错误页</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     location</span><span style=\\"color:#ABB2BF\\"> = </span><span style=\\"color:#E06C75\\">/404.html </span><span style=\\"color:#ABB2BF\\">{</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         internal</span><span style=\\"color:#ABB2BF\\">;                       </span><span style=\\"color:#7F848E;font-style:italic\\"># 不接受外部访问</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         root </span><span style=\\"color:#ABB2BF\\">/usr/share/nginx/html;     </span><span style=\\"color:#7F848E;font-style:italic\\"># 404错误页文件所在目录</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\">     # 配置重定向</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     location</span><span style=\\"color:#ABB2BF\\"> /old/ {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         rewrite</span><span style=\\"color:#E06C75\\"> ^/old/([^/]+) /new/$</span><span style=\\"color:#ABB2BF\\">1 </span><span style=\\"color:#C678DD\\">permanent</span><span style=\\"color:#ABB2BF\\">;   </span><span style=\\"color:#7F848E;font-style:italic\\"># 将/old/xxx路径重定向为/new/xxx，返回301状态码</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     }</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\"> }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 其他服务配置</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # server {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> #     ...</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic\\"> # 配置TCP负载均衡</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> upstream</span><span style=\\"color:#ABB2BF\\"> backends {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     server</span><span style=\\"color:#ABB2BF\\"> backend1.example.com:8080 </span><span style=\\"color:#E06C75;font-style:italic\\">weight</span><span style=\\"color:#ABB2BF\\">=</span><span style=\\"color:#D19A66\\">5</span><span style=\\"color:#ABB2BF\\">;  </span><span style=\\"color:#7F848E;font-style:italic\\"># 后端服务器地址和权重</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     server backend2.example.com:8080;</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     server</span><span style=\\"color:#ABB2BF\\"> backend3.example.com:8080 backup;   </span><span style=\\"color:#7F848E;font-style:italic\\"># 备用服务器</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     keepalive </span><span style=\\"color:#ABB2BF\\">16;                               </span><span style=\\"color:#7F848E;font-style:italic\\"># 连接池大小</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\"> }</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\"> server</span><span style=\\"color:#ABB2BF\\"> {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     listen </span><span style=\\"color:#ABB2BF\\">80; </span><span style=\\"color:#7F848E;font-style:italic\\">#监听端口</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     server_name </span><span style=\\"color:#ABB2BF\\">example.com;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">     location</span><span style=\\"color:#ABB2BF\\"> / {</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_pass </span><span style=\\"color:#ABB2BF\\">http://backends;             </span><span style=\\"color:#7F848E;font-style:italic\\"># 负载均衡转发请求的目标地址</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_set_header </span><span style=\\"color:#ABB2BF\\">Host $</span><span style=\\"color:#E06C75\\">host</span><span style=\\"color:#ABB2BF\\">;            </span><span style=\\"color:#7F848E;font-style:italic\\"># 设置请求头中的Host字段</span></span>\\n<span class=\\"line\\"><span style=\\"color:#C678DD\\">         proxy_set_header </span><span style=\\"color:#ABB2BF\\">X-Real-IP $</span><span style=\\"color:#E06C75\\">remote_addr</span><span style=\\"color:#ABB2BF\\">; </span><span style=\\"color:#7F848E;font-style:italic\\"># 设置请求头中的X-Real-IP字段，表示客户端真实IP</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">     }</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\"> }</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF\\">}</span></span>\\n<span class=\\"line\\"></span></code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{F as comp,b as data};
